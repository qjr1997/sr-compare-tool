# SR Compare Tool

[![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)


在进行超分辨率（Super Resolution）项目开发时，经常需要在不同的操作系统（如 macOS、Linux）之间切换工作。为了统一不同平台的效果测试体验，避免使用平台特有的软件或笨拙的浏览器页面对比，我开发了这个轻量级的Python应用。它采用最小依赖策略，只需Tkinter和Pillow库即可跨平台运行，提供一致的图像对比体验。

## 主要特性

### 核心功能

- **双模式对比**: 支持单张对比和文件夹批量对比
- **自动对齐**: 自动检测并对齐不同尺寸的图像
- **PSNR计算**: 自动计算峰值信噪比并实时显示
- **统一尺寸**: 文件夹模式下支持设置统一图像尺寸

### 对比模式

- **并排对比**: 两张图像左右并排显示，同步缩放和平移
- **快速切换**: 按住鼠标左键快速切换显示两张图像
- **滑动对比**: 使用分割线进行水平滑动对比
- **局部放大**: 鼠标悬停显示100x100区域的放大对比
- **差异显示**: 高亮显示两张图像的差异区域

### 交互控制

- **缩放控制**: 放大(+)、缩小(-)、适应窗口、100%显示
- **平移控制**: 鼠标拖拽移动图像
- **滚轮缩放**: 鼠标滚轮快速缩放
- **快捷键支持**: 数字键1-5切换模式，常用功能键

### 文件夹对比功能

- **批量加载**: 一键加载完整图像文件夹
- **自动匹配**: 智能匹配相同名称的图像对
- **翻页浏览**: ◀▶按钮切换前后图像对
- **进度指示**: 显示当前查看的图像对索引

## 安装要求

### 系统要求

- Python 3.8 或更高版本（推荐 Python 3.11）
- Tcl/Tk 8.5 或更高版本（大多数Python安装已包含）

### 依赖包

```bash
pip install pillow
```

### 验证安装

```bash
python -c "import tkinter, PIL; print('✓ 依赖验证通过')"
```

## 使用指南

### 快速开始

```bash
# 克隆或下载项目到本地目录
cd sr-compare-tool
python main.py
```

### 基础使用

1. **启动应用**: 运行 `python main.py`
2. **选择对比模式**:
   - 单张对比: 分别加载图1和图2
   - 文件夹对比: 选择两个包含待对比图像的文件夹
3. **选择显示模式**: 从下拉菜单选择对比方式
4. **交互操作**: 使用鼠标和键盘进行缩放、平移等操作

### 对比模式介绍

#### 单张对比模式

- 点击"加载图1"、"加载图2"选择两张图像
- 支持不同尺寸图像，工具会自动对齐
- 实时PSNR计算显示在状态栏

#### 文件夹对比模式

- 点击"选择文件夹1"、"选择文件夹2"选择图像文件夹
- 工具自动匹配相同名称的图像对
- 设置统一尺寸以确保一致的显示效果
- 使用翻页按钮浏览所有图像对

### 高级功能

#### PSNR峰值信噪比

- 自动计算两图像的相似度
- 数值越高表示图像越相似
- 计算结果实时显示在状态栏右侧

#### 统一尺寸设置

- 文件夹模式下可设置统一的显示尺寸
- 支持批量调整所有图像到指定分辨率
- 适合对比不同来源的图像

## 支持的图像格式

- **JPEG/JPG**: `*.jpg`, `*.jpeg`
- **PNG**: `*.png`
- **BMP**: `*.bmp`
- **TIFF**: `*.tiff`, `*.tif`
- **GIF**: `*.gif`

## 快捷键

### 模式切换

- `1`: 并排对比
- `2`: 快速切换
- `3`: 滑动对比
- `4`: 局部放大
- `5`: 差异显示

### 缩放控制

- `+`: 放大
- `-`: 缩小
- `0`: 100%显示
- `F`: 适应窗口

### 文件操作

- `O`: 加载图1
- `I`: 加载图1
- `R`: 加载图2
- `T`: 切换模式

## 技术架构

### 模块化设计

```
main.py (SRCompareApp) - 主应用协调器
├── ui_manager.py - UI组件管理和交互处理
├── file_manager.py - 文件和文件夹操作管理
├── view_controller.py - 视图状态和控制逻辑
├── psnr_calculator.py - PSNR计算和管理
└── 核心模块 (config, strategies, image_utils)
```

### 模块职责

- **UIManager**: 负责界面构建、事件处理、用户交互
- **FileManager**: 负责文件加载、对齐、文件夹批量处理
- **ViewController**: 负责图像显示、缩放、坐标转换
- **PSNRCalculator**: 负责图像质量评估计算

### 优势

- **高可维护性**: 每个模块职责单一，易于维护
- **松耦合**: 模块间通过明确接口协作
- **可扩展性**: 新功能可轻松添加到相应模块
- **代码复用**: 模块化设计便于功能复用

## API参考

### 主要类

- `SRCompareApp`: 主应用类
- `UIManager`: UI管理器
- `FileManager`: 文件管理器
- `ViewController`: 视图控制器
- `PSNRCalculator`: PSNR计算器

### 核心方法

- `load_im1()` / `load_im2()`: 加载单张图像
- `load_folder1()` / `load_folder2()`: 加载图像文件夹
- `zoom_in()` / `zoom_out()` / `fit_win()`: 视图控制
- `start_calculation()`: PSNR计算

## 开发指南

### 项目结构

```
sr-compare-tool/
├── main.py                 # 主入口程序
├── ui_manager.py           # UI管理器
├── file_manager.py         # 文件管理器
├── view_controller.py      # 视图控制器
├── psnr_calculator.py      # PSNR计算器
├── config.py              # 配置常量
├── image_utils.py         # 图像处理工具
├── strategies.py          # 绘制策略
├── requirements.txt       # 依赖列表
└── README.md              # 项目文档
```

### 添加新功能

1. 在相应模块中实现功能
2. 通过SRCompareApp属性访问
3. 保持模块间松耦合设计

## 使用技巧

### 图像对比最佳实践

- 确保对比的图像分辨率合理，避免过大图像影响性能
- 使用文件夹模式批量处理大量图像时设置合适的统一尺寸
- PSNR值参考：
  - > 40 dB: 图像质量极好
    >
  - 30-40 dB: 图像质量良好
  - 20-30 dB: 图像有可见差异
  - < 20 dB: 图像差异明显

### 性能优化

- 对于大尺寸图像，适当设置统一尺寸可提升显示性能
- 避免同时加载过多的高分辨率图像
- 程序会自动对图像进行缓存和管理

## 常见问题

### Q: 为什么图像加载很慢？

A: 大尺寸图像加载较慢，建议先设置合适的统一尺寸或调整图像分辨率。

### Q: 支持哪些图像格式？

A: 支持JPEG、PNG、BMP、TIFF等多种常见格式，详见"支持的图像格式"部分。

### Q: 如何批量对比图像？

A: 使用"文件夹对比"模式，分别选择包含待对比图像的两个文件夹，程序会自动匹配名称相同的图像对。

### Q: PSNR值是什么意思？

A: PSNR(峰值信噪比)衡量两图像相似度，数值越高表示图像越相似，通常用于评价超分辨率算法效果。

## 更新日志

### v2.0.0 (最新)

- ✨ 重构为模块化架构，提升代码可维护性
- 📁 新增文件夹批量对比功能
- 📊 集成自动PSNR计算
- 🔧 支持统一尺寸设置
- 🎨 新增差异显示模式

### v1.0.0

- 🖼️ 基础图像对比功能
- 🖱️ 多模式交互（并排、切换、滑动、放大）
- ⌨️ 快捷键支持

## 贡献指南

欢迎提交Issue和Pull Request！

1. Fork本项目
2. 创建特性分支: `git checkout -b feature/AmazingFeature`
3. 提交更改: `git commit -m 'Add some AmazingFeature'`
4. 推送到分支: `git push origin feature/AmazingFeature`
5. 创建Pull Request

## 许可证

本项目基于MIT许可证开源 - 查看[LICENSE](LICENSE)文件了解详情

## 致谢

感谢所有为这个项目贡献代码和建议的用户！

---

## 注意事项

- 工具支持16-bit图像自动转换到8-bit。
- 对于超大图像文件，建议先压缩或调整尺寸以提升性能。
